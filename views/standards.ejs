<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Show Tables</title>
  <link rel="stylesheet" href="/public/css/styles.css">
  <link rel="shortcut icon" href="/public/icon/Admin2.svg">
  <script>
    let result = '<%- result %>';
    result = JSON.parse(result);
    // console.log(result);
  </script>
  
</head>
<body>
  <header>
    
  </header>

  <main>
    <div id="buttons"></div>
    <div>
      <form id="add">
        <input 
        type="text" 
        placeholder="standard name"
        name="standard_name" 
        id="standard_name">
        <button>submit standard</button>
      </form>
    </div>
    <div id="table"></div>
  </main>

  <footer>
    
  </footer>

  <script src="/public/js/buttons.js"></script>
  <script>
    makeTable(result);
  </script>
  <script>
    let addStandard = document.getElementById('add');
    addStandard.addEventListener('submit' , (e) => {
      e.preventDefault();
      new FormData(addStandard)
    })

    addStandard.addEventListener('formdata' , async (e) => {

      const baseUrl = 'http://localhost:3000';
      const herokuUrl = 'https://fanniherfei.herokuapp.com/'

      const url = herokuUrl + '/admin/rest/standards/add';

      let data = e.formData;
      // let arr = Array.from(data.values());
      // console.log(arr);
      let formValues = {};

      data.forEach((value,key) => {
        formValues[key] = value;
        // formValues.push({ [key] : value})
      });

      console.log(formValues);

      await fetch( url , {
        method: 'POST', // or 'PUT'
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formValues),
      })


      location.reload(); 

      /* for (let value of data.values()) {
        console.log(value);
      } */

    });
  </script>
</body>
</html>